# TypeScript Diagnostic Codes & Zang Implementation

This document details the critical TypeScript Diagnostic codes relevant to Project Zang's conformance goals. Understanding these codes is essential for debugging the "Missing Errors" vs "Extra Errors" metrics.

## 1. Syntactic Diagnostics (1000–1999)

Errors generated by the **Parser**. These occur before binding or type checking.

### TS1005: `',' expected.`
*   **Description**: Generic syntax error when the parser encounters an unexpected token.
*   **Zang Context**: High frequency of false positives (~400+).
*   **Root Cause**: The Zang `Parser` is currently too strict. It often bails out or emits an error node for syntax that `tsc` (which is very lenient) accepts or recovers from.
*   **Fix Strategy**: Implement "Resynchronization" in the parser to skip invalid tokens and resume parsing, rather than aborting the node formulation.

### TS1109: `Expression expected.`
*   **Description**: The parser expected an expression but found something else (often at the start of a statement).
*   **Zang Context**: Another source of false positives alongside TS1005.

## 2. Semantic Diagnostics (2000–2999)

Errors generated by the **Binder** (symbol resolution) and **Checker** (type validation).

### TS2304: `Cannot find name 'x'.` (CRITICAL)
*   **Description**: The compiler cannot resolve a variable name to a declaration.
*   **Zang Context**: The **#1 Critical Issue**.
*   **The "Poisoning" Effect**:
    1.  Binder fails to load `lib.d.ts` correctly or merge scopes.
    2.  Standard globals like `console`, `Promise`, or `Array` become unresolved (TS2304).
    3.  The Solver encounters this unresolved symbol. To avoid crashing, it defaults to `Any`.
    4.  **Result**: `Any` suppresses all further errors. A missing binding hides type mismatches, creating a false sense of high conformance ("Missing Errors").

### TS2322: `Type 'A' is not assignable to type 'B'.`
*   **Description**: The fundamental type checking error.
*   **Zang Context**: High "Missing Errors" count.
*   **Root Cause**: The Solver's `solve_subtype` function is too permissive ("nice"). It returns `true` (compatible) for relationships it doesn't fully understand, or it is being fed `Any` types due to the TS2304 issue above.
*   **Goal**: We want *more* of these errors. It is better to have "Extra TS2322" (too strict) than "Missing TS2322" (unsound).

### TS2339: `Property 'x' does not exist on type 'Y'.`
*   **Description**: A property access failure.
*   **Zang Context**: High "Extra Errors" count.
*   **Root Cause**: The Checker isn't finding properties that *do* exist. This is often due to missing support for:
    *   Union narrowing.
    *   String index signatures.
    *   Prototype chain lookups for primitives (e.g., `string.length`).

### TS2454: `Variable 'x' is used before being assigned.`
### TS2564: `Property 'x' has no initializer...`
*   **Description**: Control Flow Analysis (CFA) errors.
*   **Component**: Requires a **Control Flow Graph (CFG)**.
*   **Zang Context**: High "Missing Errors".
*   **Implementation**: Unlike `tsc` which mutates AST nodes to add flow flags, Zang uses a side-table approach. These errors are missing because the Checker isn't fully querying that side-table yet.

## 3. Implicit Analysis (7000–7999)

Errors related to inference failures.

### TS7006: `Parameter 'x' implicitly has an 'any' type.`
*   **Description**: Occurs when usage doesn't provide enough info to infer a type.
*   **Zang Context**: "Missing Errors" here mean the compiler is silently defaulting to `Any` without warning the user. This is an unsound behavior that we must fix to match `noImplicitAny`.

## Summary of Metric Implications

| Metric | Diagnostic Status | Meaning |
| :--- | :--- | :--- |
| **Missing Errors** | Compiler didn't emit TSxxxx | **Unsound.** The compiler is too permissive or "poisoned" by Any. |
| **Extra Errors** | Compiler emitted TSxxxx (but `tsc` didn't) | **Too Strict / False Positive.** The compiler failed to understand valid code. |
