# Performance Follow-Ups

- `profiling/tooling (samply on .target-bench/dist/tsz)`: call stacks were unsymbolicated addresses only; needs build/profile configuration work (debug symbols + symbolization path) before flamegraph-level analysis is reliable.
- `crates/tsz-checker/src/state/state_type_environment.rs::build_type_environment`: still spends significant time in upfront symbol/type environment population; deeper redesign to defer more `get_type_of_symbol` work is architectural and not a small targeted optimization.
- `crates/tsz-lowering/src/lower.rs::TypeLowering::lower_merged_interface_declarations / collect_interface_members`: still hot in `ts-essentials/paths.ts`; caching merged lib-interface lowering likely helps, but needs cross-arena cache keys and invalidation design beyond a small safe patch.
- `crates/tsz-checker/src/types/type_checking_global.rs::register_boxed_types`: still performs broad generic lib prewarm per file; reducing this further likely requires changing when `TypeEnvironment` is rebuilt, which is a larger architectural change.
- `crates/tsz-checker/src/types/type_checking_queries_class.rs::resolve_lib_type_by_name` resolver closure: NodeIndex-based cross-arena lookup still scans declaration arenas per query; optimizing further needs arena-aware memo keys to avoid incorrect cache hits.
- `crates/tsz-cli/src/bin/tsz.rs::main (large-stack thread spawn)`: full removal of the large-stack thread was skipped; kept for multi-file/project paths because deep type-environment recursion can still require larger stacks.
- `crates/tsz-checker/src/types/type_checking_queries_class.rs::resolve_lib_type_by_name`: deeper memoization of merged lib declarations was investigated but skipped because safe cross-arena cache invalidation needs explicit architecture work.
